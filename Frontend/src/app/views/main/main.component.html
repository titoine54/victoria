<ul *ngIf="global.apList?.length > 0" materialize="collapsible" class="collapsible" data-collapsible="accordion">
  <li *ngFor="let ap of global.apList | withApStats:global.evaluations">

    <div class="collapsible-header waves-effect">
      <b>{{ ap.apCode }}</b> - {{ ap.titre }} ({{ ap.credit }} cr.)
      <span *ngIf="ap.stats.remaining > 0" class="badge blue-badge">Points à combler: {{ ap.stats.remaining }}</span>
      <span class="badge">{{ ap.stats.string }}</span>
      <span class="new" *ngIf="ap | hasNewEvaluation:global.evaluations">&bull;</span>

      <div class="progress">
        <div class="ap-progress determinate" [style.width]="ap.stats.remainingPercent" [attr.data-tooltip]="ap.stats.string" materialize="tooltip" data-delay="30" data-position="top"></div>
        <div class="user-progress determinate" [style.width]="ap.stats.percent"></div>
        <div class="bareme-progress determinate" [style.left]="ap.bareme+'%'" [attr.data-tooltip]="'Barème: '+ap.bareme+'%'" materialize="tooltip" data-delay="30" data-position="top"></div>
      </div>
    </div>

    <div class="collapsible-body active grey lighten-4">
      <blockquote *ngIf="ap.description" class="caption">
        {{ ap.description }}
      </blockquote>

      <app-ap-competences [ap]="ap" (onRequestNoteModal)="noteModal.show($event)"></app-ap-competences>
    </div>
  </li>
</ul>

<!--When loading notes-->
<loading *ngIf="global.apList == undefined"></loading>

<!--When api call failed-->
<div *ngIf="global.apList?.length == 0" class="container">
  <br>
  <h5>Un problème est survenu lors de la récupération de vos notes.</h5>
  <p>Veuillez réessayer plus tard.</p>
</div>

<app-note-modal></app-note-modal>